<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OpenEVmap</title>
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>

    <!--APP-->
    <div class="app">


      <!--Information-->
      <aside class="side-modal bottom-modal hidden" id="infoModal">
          <div class="modal-header">
            <h2 id="modalTitle">Charging station</h2>
            <button id="closeModal" class="close">
              <img src="{{ url_for('static', filename='icons/cross.svg') }}" alt="Close" />
            </button>
          </div>
          <div class="modal-body">
            <form id="editForm">
              <!--div class="form-row">
                <label for="source">Source</label>
                <input id="source" name="source" type="text" placeholder="survey" />
              </div-->
              <div class="form-row">
                <label for="name">Name</label>
                <input id="name" name="name" type="text" />
              </div>
              <div class="form-row">
                <label for="operator">Operator</label>
                <input id="operator" name="operator" type="text" />
              </div>
              <div class="form-row">
                <label for="brand">Brand</label>
                <input id="brand" name="brand" type="text" />
              </div>
              <div class="form-row">
                <label for="capacity">Capacity</label>
                <input id="capacity" name="capacity" type="number" min="0" />
              </div>
              <p class="hint">Capacity = number of parking spaces, not connectors.</p>

              <span class="divider"></span>

              <!-- Socket types -->

              <div class="form-column">
                <h4>Socket types</h4>
                <div class="socket-buttons">
                  <button type="button" class="socket-btn" data-scope="edit" data-row="socket_row_type1" aria-pressed="false">
                    <img src="/static/icons/type1.svg" alt="Type1 J1772" />
                    <span>Type1 J1772</span>
                  </button>

                  <button type="button" class="socket-btn" data-scope="edit" data-row="socket_row_type2" aria-pressed="false">
                    <img src="/static/icons/type2.svg" alt="Type2 Mennekes" />
                    <span>Type2 Mennekes</span>
                  </button>

                  <button type="button" class="socket-btn" data-scope="edit" data-row="socket_row_chademo" aria-pressed="false">
                    <img src="/static/icons/chademo.svg" alt="CHAdeMO" />
                    <span>CHAdeMO</span>
                  </button>

                  <button type="button" class="socket-btn" data-scope="edit" data-row="socket_row_ccs1" aria-pressed="false">
                    <img src="/static/icons/css1.svg" alt="CCS Combo Type 1" />
                    <span>CCS Combo Type 1</span>
                  </button>

                  <button type="button" class="socket-btn" data-scope="edit" data-row="socket_row_ccs" aria-pressed="false">
                    <img src="/static/icons/css2.svg" alt="CCS Combo Type 2" />
                    <span>CCS Combo Type 2</span>
                  </button>

                  <button type="button" class="socket-btn" data-scope="edit" data-row="socket_row_gbt" aria-pressed="false">
                    <img src="/static/icons/gbt.svg" alt="GB/T" />
                    <span>GB/T</span>
                  </button>
                </div>
                <div class="socket-details">
                  <div class="form-row  hidden" id="socket_row_type1">
                    <label for="socket_type1_count">Type1<br>J1772</label>
                    <div class="socket-fields">
                      <input id="socket_type1_count" name="socket:type1" type="number" min="0" step="1" placeholder="Count" />
                      <input id="socket_type1_power" name="socket:type1:output" type="text" placeholder="Power (kW)" />
                    </div>
                  </div>
                  <div class="form-row  hidden" id="socket_row_type2">
                    <label for="socket_type2_count">Type2 Mennekes</label>
                    <div class="socket-fields">
                      <input id="socket_type2_count" name="socket:type2" type="number" min="0" step="1" placeholder="Count" />
                      <input id="socket_type2_power" name="socket:type2:output" type="text" placeholder="Power (kW)" />
                    </div>
                  </div>
                  <div class="form-row  hidden" id="socket_row_chademo">
                    <label for="socket_chademo_count">CHAdeMO</label>
                    <div class="socket-fields">
                      <input id="socket_chademo_count" name="socket:chademo" type="number" min="0" step="1" placeholder="Count" />
                      <input id="socket_chademo_power" name="socket:chademo:output" type="text" placeholder="Power (kW)" />
                    </div>
                  </div>
                  <div class="form-row  hidden" id="socket_row_ccs1">
                    <label for="socket_ccs1_count">CCS Combo Type 1</label>
                    <div class="socket-fields">
                      <input id="socket_ccs1_count" name="socket:ccs1" type="number" min="0" step="1" placeholder="Count" />
                      <input id="socket_ccs1_power" name="socket:ccs1:output" type="text" placeholder="Power (kW)" />
                    </div>
                  </div>
                  <div class="form-row  hidden" id="socket_row_ccs">
                    <label for="socket_ccs_count">CCS Combo Type 2</label>
                    <div class="socket-fields">
                      <input id="socket_ccs_count" name="socket:ccs" type="number" min="0" step="1" placeholder="Count" />
                      <input id="socket_ccs_power" name="socket:ccs:output" type="text" placeholder="Power (kW)" />
                    </div>
                  </div>
                  <div class="form-row  hidden" id="socket_row_gbt">
                    <label for="socket_gbt_count">GB/T</label>
                    <div class="socket-fields">
                      <input id="socket_gbt_count" name="socket:gbt" type="number" min="0" step="1" placeholder="Count" />
                      <input id="socket_gbt_power" name="socket:gbt:output" type="text" placeholder="Power (kW)" />
                    </div>
                  </div>
                </div>
              </div>

              <span class="divider"></span>

              <!-- Fee -->
              <div class="cell">
                
                <label>
                  
                  <input class="checkbox" id="fee" name="fee" type="checkbox" />
                </label>
                <p>Fee</p>
              </div>

              <div class="form-row" id="costRow">
                <label for="cost">Cost</label>
                <input id="cost" name="cost" type="text" placeholder="e.g. 1000 KZT/hour or free" />
              </div>

              <!-- Hours -->
              <div class="form-row">
                <label for="opening_hours">Hours</label>
                <input id="opening_hours" name="opening_hours" type="text" />
              </div>

              <!-- Access -->
              <div class="form-row">
                <label for="access">Access</label>
                <select id="access" name="access">
                  <option value="">Select access</option>
                  <option value="yes">Public</option>
                  <option value="customers">Customers</option>
                  <option value="private">Private</option>
                  <option value="permissive">Permissive</option>
                  <option value="destination">Destination</option>
                  <option value="no">No access</option>
                </select>
              </div>

              <!--Save-->
              <div class="panel-footer">
                <button type="submit" class="btn_action_label" id="saveBtn">Save</button>
              </div>
              <p class="hint" id="modalHint"></p>
            </form>
          </div>
      </aside>

      <!--Filters-->
      <aside class="filters-modal bottom-modal hidden" id="filtersModal">
          <div class="modal-header">
            <h2>Filters</h2>

            <!--Close-->
            <button id="closeFilters" class="close">
              <img src="{{ url_for('static', filename='icons/cross.svg') }}" alt="Close" />
            </button>

          </div>
          <div class="modal-body">
            <label class="filter-toggle">
              <input type="checkbox" id="filterAll" checked />
              Show all
            </label>
            <div class="form-column">
              <h4>Socket types</h4>
              <div class="socket-buttons">
                <button type="button" class="socket-btn" data-scope="filter" data-target="filter_socket_type1" aria-pressed="false">
                  <img src="/static/icons/type1.svg" alt="Type1 J1772" />
                  <span>Type1 J1772</span>
                </button>

                <button type="button" class="socket-btn" data-scope="filter" data-target="filter_socket_type2" aria-pressed="false">
                  <img src="/static/icons/type2.svg" alt="Type2 Mennekes" />
                  <span>Type2 Mennekes</span>
                </button>

                <button type="button" class="socket-btn" data-scope="filter" data-target="filter_socket_chademo" aria-pressed="false">
                  <img src="/static/icons/chademo.svg" alt="CHAdeMO" />
                  <span>CHAdeMO</span>
                </button>

                <button type="button" class="socket-btn" data-scope="filter" data-target="filter_socket_ccs1" aria-pressed="false">
                  <img src="/static/icons/css1.svg" alt="CCS Combo Type 1" />
                  <span>CCS Combo Type 1</span>
                </button>

                <button type="button" class="socket-btn" data-scope="filter" data-target="filter_socket_ccs" aria-pressed="false">
                  <img src="/static/icons/css2.svg" alt="CCS Combo Type 2" />
                  <span>CCS Combo Type 2</span>
                </button>

                <button type="button" class="socket-btn" data-scope="filter" data-target="filter_socket_gbt" aria-pressed="false">
                  <img src="/static/icons/gbt.svg" alt="GB/T" />
                  <span>GB/T</span>
                </button>

              </div>
              <input id="filter_socket_type1" type="checkbox" class="hidden-input" />
              <input id="filter_socket_type2" type="checkbox" class="hidden-input" />
              <input id="filter_socket_chademo" type="checkbox" class="hidden-input" />
              <input id="filter_socket_ccs1" type="checkbox" class="hidden-input" />
              <input id="filter_socket_ccs" type="checkbox" class="hidden-input" />
              <input id="filter_socket_gbt" type="checkbox" class="hidden-input" />
            </div>

            <div class="panel-footer">
              <button type="button" id="saveFiltersBtn" class="btn_action_label">Save</button>
            </div>
            
          </div>
      </aside>


      <!--On te map-->
      <div class="m-top-right">

        <!--My location-->
        <button id="geoBtn">
          <img src="/static/icons/pin.svg" alt="Geolocate" />
        </button>


        <!--Filter-->
        <button id="filtersBtn" type="button">
              <img src="/static/icons/funnel.svg" alt="Filters">
        </button>


        <!--Upload-->
        <button id="uploadBtn">
              <img src="{{ url_for('static', filename='icons/upload.svg') }}" alt="Filters" />
        </button>

        
      </div>



      <!--Bottom tray-->
      <div id="shell-tray">
        <div id="shell-tray-bg"></div>

        <div id="shell-tray-card-container">
          <div class="mw-card" data-ref="search-ref" tabindex="-1">
            <div class="mw-card-handle"></div>

            

            <div class="mw-inner">
              <div class="mw-search-container" aria-labelledby="search-header">
                <div class="mw-search-header-title">
                  <div class="nav-header">
                    <div class="mw-left-section">
                      <h1 class="visually-hidden">OpenEVmap</h1>
                    </div>
                  </div>
        
                </div>

                <form class="mw-search-header" role="region" aria-label="Search" tabindex="-1">
                  <div id="mw-search-bar-and-results">
                    <div class="mw-search-bar-container">
                      <label class="mw-search-bar">
                        <div class="sc-icon">
                          <div class="sc-symbol magnifyingglass"></div>
                        </div>
                        <input
                          type="search"
                          id="searchInput"
                          dir="auto"
                          placeholder="Search"
                          autocomplete="off"
                          autocapitalize="off"
                          spellcheck="false"
                          role="combobox"
                          aria-autocomplete="list"
                          aria-expanded="false"
                          value=""
                        />
                      </label>
                      <button type="button" id="searchBtn" class="mw-cancel-button is-hidden">Search</button>
                    </div>
                  </div>
                </form>
              </div>


              <!--VStack-->
              <div class="vstack">
                <div class="vstack_cell" id="authArea"></div>

                <button class="vstack_cell" id="projectInfoBtn">
                  <p>Information</p>
                  <img src="{{ url_for('static', filename='icons/chevron.svg') }}" alt="Info" />
                </button>

              </div>

              <!--Copyright-->
              <div class="copyright">
                  <p>OpenEVmap Beta 1.0</p>
                  <p>2026</p>
                </div>


            </div>
          </div>
        </div>
      </div>

      <div class="filters-overlay hidden" id="infoOverlay"></div>
      <aside class="filters-modal bottom-modal hidden" id="infoModalCard">
        <div class="modal-header">
          <h2>About OpenEVmap</h2>
          <button id="closeInfo" class="close">
            <img src="{{ url_for('static', filename='icons/cross.svg') }}" alt="Close" />
          </button>
        </div>
        <div class="modal-body">
          <div class="info-content">
            <h3>OpenEVmap</h3>
            <p>OpenEVmap is an open-source tool for mapping and maintaining EV charging stations in OpenStreetMap.</p>
            <p>It helps contributors, EV operators, and developers add and edit EV charging infrastructure data correctly, consistently, and with respect to the OpenStreetMap ecosystem.</p>
            <p>OpenEVmap does not create a separate or closed database. All edits are made directly to OpenStreetMap.</p>

            <h3>Mission</h3>
            <p>Make EV charging infrastructure data in OpenStreetMap accurate, up to date, easy to contribute to, and useful for everyone.</p>

            <h3>Key principles</h3>
            <ul>
              <li>Open-first — all data belongs to OpenStreetMap.</li>
              <li>OSM-friendly — built with respect for OSM rules, tagging practices, and community standards.</li>
              <li>EV-focused — only electric vehicle charging infrastructure.</li>
              <li>Low barrier to entry — accessible to non-expert mappers and EV operators.</li>
              <li>No vendor lock-in — OpenEVmap is tooling, not a data silo.</li>
            </ul>

            <h3>Features (planned & in progress)</h3>
            <ul>
              <li>OAuth login via OpenStreetMap</li>
              <li>Create new EV charging stations (POI)</li>
              <li>Edit existing charging stations</li>
              <li>Guided EV-specific tagging (connectors, power, access, payment, operator)</li>
              <li>Validation to prevent common tagging mistakes</li>
              <li>Change preview before submitting edits</li>
              <li>Source attribution support</li>
              <li>Minimal, focused UI for EV mapping</li>
            </ul>

            <h3>Authentication</h3>
            <p>OpenEVmap uses OpenStreetMap OAuth for authentication. Users edit data under their own OSM account. All changes are transparent and fully traceable in OSM history.</p>

            <h3>Why OpenEVmap exists</h3>
            <p>Mapping EV charging stations directly in OpenStreetMap is powerful but often complex. OpenEVmap reduces incorrect tagging, prevents duplicate POIs, and helps EV operators contribute clean data.</p>

            <h3>Relationship to commercial products</h3>
            <p>OpenEVmap is an open, community-oriented project. It is developed alongside a commercial EV product, but it does not restrict access to data and improves shared infrastructure for everyone.</p>

            <h3>Project status</h3>
            <p>Early development / MVP stage. Initial focus: core editing flow, correct EV tagging, safe OSM integration.</p>

            <h3>Contributing</h3>
            <p>Contributions are welcome: code, UX feedback, OSM tagging expertise, and testing in different regions.</p>

            <h3>License</h3>
            <p>TBD (likely MIT or similar permissive license)</p>

            <h3>Links</h3>
            <p>OpenStreetMap: https://www.openstreetmap.org</p>
            <p>Project repository: coming soon</p>
            <p>Open tools for better EV maps.</p>
          </div>
        </div>
      </aside>




      <!--Body-->
      <div class="content">

        


        <div id="map"></div>
        <div id="loadingStatus" class="loading-indicator hidden">
          Loading points...
        </div>
        <div id="zoomHint" class="loading-indicator hidden">
          Zoom in to load points.
        </div>



        




        
      </div>

    </div>




    <script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
    <script>
      window.MAPBOX_TOKEN = "{{ mapbox_token }}";
    </script>
    <script src="/static/app.js"></script>
  </body>
</html>
